<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Guerre des Pays</title>
    
    <style>
        /* Variables CSS */
        :root {
            --glass-bg: rgba(255, 255, 255, 0.1);
            --glass-border: rgba(255, 255, 255, 0.2);
            --primary: #007AFF;
            --danger: #FF3B30;
            --success: #34C759;
            --text: #1C1C1E;
            --text-secondary: #8E8E93;
            --bg: #F2F2F7;
            --card-bg: rgba(255, 255, 255, 0.7);
        }

        /* Reset et base */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: var(--text);
            line-height: 1.6;
            overflow-x: hidden;
        }

        /* Glassmorphism */
        .glass {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .card {
            background: var(--card-bg);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-radius: 16px;
            padding: 20px;
            margin: 10px 0;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.08);
        }

        /* Container */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Header */
        header {
            text-align: center;
            padding: 30px 0;
        }

        h1 {
            font-size: 2.5em;
            font-weight: 700;
            color: white;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
            margin-bottom: 20px;
        }

        /* Language Selector */
        .lang-selector {
            position: absolute;
            top: 20px;
            right: 20px;
        }

        select {
            padding: 10px 20px;
            border-radius: 10px;
            border: none;
            background: white;
            font-size: 16px;
            cursor: pointer;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        /* Player Profile */
        .player-profile {
            display: flex;
            align-items: center;
            gap: 20px;
            padding: 20px;
            margin-bottom: 30px;
        }

        .avatar {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            background: white;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
        }

        .player-info {
            flex: 1;
        }

        .player-info h2 {
            font-size: 1.5em;
            margin-bottom: 5px;
        }

        .player-info p {
            color: var(--text-secondary);
        }

        /* Avatar Setup */
        .avatar-setup {
            text-align: center;
            padding: 30px;
        }

        .avatar-choice {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin: 20px 0;
        }

        /* Accessibility improvements for iPad/touch */
        .avatar-option {
            cursor: pointer;
            padding: 30px;
            border-radius: 20px;
            transition: all 0.3s ease;
            border: 3px solid transparent;
            background: var(--card-bg);
            min-width: 150px;
            touch-action: manipulation;
        }

        .avatar-option:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            background: rgba(255, 255, 255, 0.9);
        }

        .avatar-option.selected {
            border-color: var(--primary);
            background: rgba(0, 122, 255, 0.1);
            transform: scale(1.05);
        }

        /* Forms */
        .form-group {
            margin: 15px 0;
            text-align: left;
            max-width: 400px;
            margin-left: auto;
            margin-right: auto;
        }

        label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: var(--text);
        }

        input {
            width: 100%;
            padding: 16px 20px;
            border-radius: 12px;
            border: 2px solid #E5E5EA;
            font-size: 18px;
            transition: all 0.3s ease;
            min-height: 50px;
        }

        input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(0, 122, 255, 0.1);
        }

        /* Buttons */
        .btn {
            padding: 16px 32px;
            border-radius: 12px;
            border: none;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-block;
            text-align: center;
            touch-action: manipulation;
            min-height: 50px;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background: #0051D5;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 122, 255, 0.3);
        }

        .btn-danger {
            background: var(--danger);
            color: white;
        }

        .btn-success {
            background: var(--success);
            color: white;
        }

        .btn-small {
            padding: 8px 16px;
            font-size: 14px;
        }

        /* Country List */
        .countries-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        .country-card {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 15px;
        }

        .country-info {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .country-flag {
            font-size: 2em;
        }

        .country-name {
            font-weight: 600;
        }

        .country-xp {
            font-size: 0.9em;
            color: var(--text-secondary);
        }

        .country-actions {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .status {
            padding: 4px 8px;
            border-radius: 6px;
            font-size: 0.8em;
            font-weight: 600;
        }

        .status-war {
            background: rgba(255, 59, 48, 0.1);
            color: var(--danger);
        }

        .status-peace {
            background: rgba(52, 199, 89, 0.1);
            color: var(--success);
        }

        /* Marriage Section */
        .marriage-section {
            text-align: center;
            padding: 30px;
            margin: 30px 0;
        }

        .selected-countries {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 20px 0;
        }

        .selected-country {
            padding: 10px 20px;
            background: rgba(0, 122, 255, 0.1);
            border-radius: 10px;
            font-weight: 600;
        }

        /* Random Event */
        .random-event {
            text-align: center;
            margin: 30px 0;
        }

        .event-message {
            margin-top: 20px;
            padding: 20px;
            font-size: 1.2em;
            font-weight: 600;
            color: var(--primary);
        }

        /* Accessibility */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .player-profile {
                flex-direction: column;
                text-align: center;
            }

            .countries-container {
                grid-template-columns: 1fr;
            }

            .country-card {
                flex-direction: column;
                gap: 10px;
            }

            h1 {
                font-size: 2em;
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 15px;
            }
            
            .stat-card {
                padding: 15px;
            }
            
            .stat-icon {
                font-size: 2em;
            }
            
            .stat-value {
                font-size: 1.5em;
            }
        }

        /* Animations */
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .fade-in {
            animation: fadeIn 0.5s ease;
        }

        /* Statistics Section */
        .statistics-section {
            margin-bottom: 30px;
            padding: 30px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-radius: 16px;
            padding: 20px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }

        .stat-card:nth-child(1) .stat-value { color: var(--danger); }
        .stat-card:nth-child(2) .stat-value { color: var(--success); }
        .stat-card:nth-child(3) .stat-value { color: #E91E63; }
        .stat-card:nth-child(4) .stat-value { color: #FFD700; }

        .stat-icon {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .stat-value {
            font-size: 2em;
            font-weight: 700;
            color: var(--primary);
            margin: 10px 0;
        }

        .stat-label {
            font-size: 0.9em;
            color: var(--text-secondary);
        }

        .war-history {
            margin-top: 30px;
        }

        .war-history h4 {
            margin-bottom: 15px;
            font-size: 1.2em;
        }

        .history-list {
            max-height: 200px;
            overflow-y: auto;
            padding: 10px;
            background: rgba(0, 0, 0, 0.05);
            border-radius: 10px;
        }

        .history-item {
            padding: 8px 12px;
            margin: 5px 0;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            font-size: 0.9em;
            animation: slideIn 0.3s ease;
        }

        .leaderboard {
            margin-top: 30px;
        }

        .leaderboard-list {
            list-style: none;
            padding: 0;
        }

        .leaderboard-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 12px;
            margin: 5px 0;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            font-size: 0.9em;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(-20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        /* Hide/Show */
        .hidden {
            display: none !important;
        }
    </style>
</head>
<body>
    <!-- Language Selector -->
    <div class="lang-selector">
        <select id="languageSelect" aria-label="Choisir la langue">
            <option value="fr">Fran√ßais</option>
            <option value="ar">ÿßŸÑÿπÿ±ÿ®Ÿäÿ©</option>
            <option value="es">Espa√±ol</option>
            <option value="it">Italiano</option>
            <option value="en">English</option>
        </select>
    </div>

    <!-- Header -->
    <header>
        <h1 id="gameTitle">Guerre des Pays</h1>
    </header>

    <div class="container">
        <!-- Player Profile (Hidden initially) -->
        <div id="playerProfile" class="player-profile glass hidden">
            <div class="avatar" id="playerAvatar"></div>
            <div class="player-info">
                <h2 id="playerName"></h2>
                <p id="playerDetails"></p>
            </div>
        </div>

        <!-- Avatar Setup -->
        <div id="avatarSetup" class="avatar-setup card">
            <h2 id="chooseAvatar">Choisissez votre avatar</h2>
            <p style="color: var(--text-secondary); margin-bottom: 20px;">Cliquez sur l'avatar de votre choix</p>
            <div class="avatar-choice">
                <div class="avatar-option" data-gender="male" tabindex="0" role="button" aria-label="Choisir avatar homme">
                    <svg width="100" height="100" viewBox="0 0 100 100">
                        <circle cx="50" cy="50" r="45" fill="#4A90E2"/>
                        <circle cx="50" cy="40" r="20" fill="#FFE0BD"/>
                        <path d="M30 70 Q50 80 70 70" fill="#4A90E2"/>
                        <circle cx="40" cy="38" r="3" fill="#333"/>
                        <circle cx="60" cy="38" r="3" fill="#333"/>
                        <path d="M45 48 Q50 52 55 48" stroke="#333" stroke-width="2" fill="none"/>
                    </svg>
                    <p id="maleLabel">Homme</p>
                </div>
                <div class="avatar-option" data-gender="female" tabindex="0" role="button" aria-label="Choisir avatar femme">
                    <svg width="100" height="100" viewBox="0 0 100 100">
                        <circle cx="50" cy="50" r="45" fill="#E91E63"/>
                        <circle cx="50" cy="40" r="20" fill="#FFE0BD"/>
                        <path d="M30 70 Q50 80 70 70" fill="#E91E63"/>
                        <circle cx="40" cy="38" r="3" fill="#333"/>
                        <circle cx="60" cy="38" r="3" fill="#333"/>
                        <path d="M45 48 Q50 52 55 48" stroke="#333" stroke-width="2" fill="none"/>
                        <path d="M30 25 Q50 15 70 25" fill="#8B4513" stroke="none"/>
                    </svg>
                    <p id="femaleLabel">Femme</p>
                </div>
            </div>

            <form id="playerForm" class="hidden">
                <div class="form-group">
                    <label for="firstName" id="firstNameLabel">Pr√©nom</label>
                    <input type="text" id="firstName" required>
                </div>
                <div class="form-group">
                    <label for="lastName" id="lastNameLabel">Nom de famille</label>
                    <input type="text" id="lastName" required>
                </div>
                <div class="form-group">
                    <label for="birthDate" id="birthDateLabel">Date de naissance</label>
                    <input type="date" id="birthDate" required>
                </div>
                <div class="form-group">
                    <label for="origin" id="originLabel">Origine</label>
                    <input type="text" id="origin" required>
                </div>
                <button type="submit" class="btn btn-primary" id="startGame">Commencer le jeu</button>
                <button type="button" class="btn btn-primary" onclick="quickStart()" style="margin-left: 10px; background: #34C759;">Jouer en tant que Yugurtha üá©üáø</button>
                <p style="margin-top: 10px; color: var(--text-secondary); font-size: 0.9em;">Assurez-vous de remplir tous les champs</p>
            </form>
        </div>

        <!-- Game Section (Hidden initially) -->
        <div id="gameSection" class="hidden">
            <!-- Statistics Section -->
            <div class="statistics-section card">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <h3 id="statsTitle" style="margin: 0;">üìä Statistiques de Guerre</h3>
                    <button class="btn btn-small" onclick="resetStats()">üîÑ</button>
                </div>
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon">‚öîÔ∏è</div>
                        <div class="stat-value" id="totalWars">0</div>
                        <div class="stat-label" id="warsLabel">Guerres actives</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">üïäÔ∏è</div>
                        <div class="stat-value" id="totalPeace">195</div>
                        <div class="stat-label" id="peaceLabel">Pays en paix</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">üíë</div>
                        <div class="stat-value" id="totalMarriages">0</div>
                        <div class="stat-label" id="marriagesLabel">Mariages c√©l√©br√©s</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">üèÜ</div>
                        <div class="stat-value" id="topCountry">-</div>
                        <div class="stat-label" id="topCountryLabel">Pays le plus fort</div>
                    </div>
                </div>
                <div class="war-history">
                    <h4 id="historyTitle">üìú Historique r√©cent</h4>
                    <div id="historyList" class="history-list"></div>
                </div>
                <div class="leaderboard">
                    <h4 id="leaderboardTitle">üèÖ Classement XP</h4>
                    <ol id="leaderboardList" class="leaderboard-list"></ol>
                </div>
            </div>

            <!-- Marriage Section -->
            <div class="marriage-section card">
                <h3 id="marriageTitle">Mariage entre pays</h3>
                <div class="selected-countries" id="selectedCountries"></div>
                <button class="btn btn-primary" id="marryBtn" disabled>Marier les pays</button>
                <div id="marriageMessage" class="event-message"></div>
            </div>

            <!-- Random Event -->
            <div class="random-event card">
                <button class="btn btn-primary" id="randomEventBtn">Random Event</button>
                <div id="eventMessage" class="event-message"></div>
            </div>

            <!-- Countries List -->
            <div class="countries-container" id="countriesList"></div>
        </div>
    </div>

    <script>
        // Translations
        const translations = {
            fr: {
                gameTitle: "Guerre des Pays",
                chooseAvatar: "Choisissez votre avatar",
                male: "Homme",
                female: "Femme",
                firstName: "Pr√©nom",
                lastName: "Nom de famille",
                birthDate: "Date de naissance",
                origin: "Origine",
                startGame: "Commencer le jeu",
                marriageTitle: "Mariage entre pays",
                marryCountries: "Marier les pays",
                randomEvent: "Random Event",
                declareWar: "D√©clarer la guerre",
                makePeace: "Faire la paix",
                war: "Guerre",
                peace: "Paix",
                select: "S√©lectionner",
                selected: "S√©lectionn√©",
                hello: "Bonjour",
                hi: "Coucou",
                iLoveYou: "Je t'aime",
                iAdoreYou: "Je t'adore",
                israelWarning: "Faire attention ! Isra√´l qui guerre au Liban !",
                kiss: "Bisou",
                moroccanAlgerianMarriage: "Bravo ! Marocaine se marier avec Alg√©rien üéâ",
                marriageSuccess: "Mariage r√©ussi entre {country1} et {country2} ! üíë",
                needTwoCountries: "S√©lectionnez deux pays pour les marier",
                xpPoints: "XP: {xp} points",
                statsTitle: "üìä Statistiques de Guerre",
                warsLabel: "Guerres actives",
                peaceLabel: "Pays en paix",
                marriagesLabel: "Mariages c√©l√©br√©s",
                topCountryLabel: "Pays le plus fort",
                leaderboardTitle: "üèÖ Classement XP",
                historyTitle: "üìú Historique r√©cent",
                warDeclared: "{country1} d√©clare la guerre √† {country2} ‚öîÔ∏è",
                peaceMade: "{country1} fait la paix avec {country2} üïäÔ∏è",
                marriageCelebrated: "Mariage c√©l√©br√© : {country1} üíë {country2}"
            },
            ar: {
                gameTitle: "ÿ≠ÿ±ÿ® ÿßŸÑÿ®ŸÑÿØÿßŸÜ",
                chooseAvatar: "ÿßÿÆÿ™ÿ± ÿµŸàÿ±ÿ™ŸÉ ÿßŸÑÿ±ŸÖÿ≤Ÿäÿ©",
                male: "ÿ±ÿ¨ŸÑ",
                female: "ÿßŸÖÿ±ÿ£ÿ©",
                firstName: "ÿßŸÑÿßÿ≥ŸÖ ÿßŸÑÿ£ŸàŸÑ",
                lastName: "ÿßÿ≥ŸÖ ÿßŸÑÿπÿßÿ¶ŸÑÿ©",
                birthDate: "ÿ™ÿßÿ±ŸäÿÆ ÿßŸÑŸÖŸäŸÑÿßÿØ",
                origin: "ÿßŸÑÿ£ÿµŸÑ",
                startGame: "ÿßÿ®ÿØÿ£ ÿßŸÑŸÑÿπÿ®ÿ©",
                marriageTitle: "ÿßŸÑÿ≤Ÿàÿßÿ¨ ÿ®ŸäŸÜ ÿßŸÑÿ®ŸÑÿØÿßŸÜ",
                marryCountries: "ÿ≤Ÿàÿ¨ ÿßŸÑÿ®ŸÑÿØÿßŸÜ",
                randomEvent: "ÿ≠ÿØÿ´ ÿπÿ¥Ÿàÿßÿ¶Ÿä",
                declareWar: "ÿ£ÿπŸÑŸÜ ÿßŸÑÿ≠ÿ±ÿ®",
                makePeace: "ÿßÿµŸÜÿπ ÿßŸÑÿ≥ŸÑÿßŸÖ",
                war: "ÿ≠ÿ±ÿ®",
                peace: "ÿ≥ŸÑÿßŸÖ",
                select: "ÿßÿÆÿ™ÿ±",
                selected: "ŸÖÿÆÿ™ÿßÿ±",
                hello: "ŸÖÿ±ÿ≠ÿ®ÿß",
                hi: "ÿ£ŸáŸÑÿß",
                iLoveYou: "ÿ£ÿ≠ÿ®ŸÉ",
                iAdoreYou: "ÿ£ÿπÿ¥ŸÇŸÉ",
                israelWarning: "ÿßŸÜÿ™ÿ®Ÿá! ÿ•ÿ≥ÿ±ÿßÿ¶ŸäŸÑ ÿ™ÿ≠ÿßÿ±ÿ® ŸÑÿ®ŸÜÿßŸÜ!",
                kiss: "ŸÇÿ®ŸÑÿ©",
                moroccanAlgerianMarriage: "ŸÖÿ®ÿ±ŸàŸÉ! ŸÖÿ∫ÿ±ÿ®Ÿäÿ© ÿ™ÿ™ÿ≤Ÿàÿ¨ ÿ¨ÿ≤ÿßÿ¶ÿ±Ÿä üéâ",
                marriageSuccess: "ÿ≤Ÿàÿßÿ¨ ŸÜÿßÿ¨ÿ≠ ÿ®ŸäŸÜ {country1} Ÿà {country2} ! üíë",
                needTwoCountries: "ÿßÿÆÿ™ÿ± ÿØŸàŸÑÿ™ŸäŸÜ ŸÑŸÑÿ≤Ÿàÿßÿ¨",
                xpPoints: "ŸÜŸÇÿßÿ∑ ÿßŸÑÿÆÿ®ÿ±ÿ©: {xp}",
                statsTitle: "üìä ÿ•ÿ≠ÿµÿßÿ¶Ÿäÿßÿ™ ÿßŸÑÿ≠ÿ±ÿ®",
                warsLabel: "ÿ≠ÿ±Ÿàÿ® ŸÜÿ¥ÿ∑ÿ©",
                peaceLabel: "ÿØŸàŸÑ ŸÅŸä ÿ≥ŸÑÿßŸÖ",
                marriagesLabel: "ÿ≤Ÿäÿ¨ÿßÿ™ ÿ™ŸÖÿ™",
                topCountryLabel: "ÿ£ŸÇŸàŸâ ÿØŸàŸÑÿ©",
                leaderboardTitle: "üèÖ ÿßŸÑÿ™ÿ±ÿ™Ÿäÿ®",
                historyTitle: "üìú ÿßŸÑÿ™ÿßÿ±ŸäÿÆ ÿßŸÑÿ≠ÿØŸäÿ´",
                warDeclared: "{country1} ŸäÿπŸÑŸÜ ÿßŸÑÿ≠ÿ±ÿ® ÿπŸÑŸâ {country2} ‚öîÔ∏è",
                peaceMade: "{country1} ŸäÿµŸÜÿπ ÿßŸÑÿ≥ŸÑÿßŸÖ ŸÖÿπ {country2} üïäÔ∏è",
                marriageCelebrated: "ÿ≤Ÿàÿßÿ¨ ÿ™ŸÖ : {country1} üíë {country2}"
            },
            es: {
                gameTitle: "Guerra de Pa√≠ses",
                chooseAvatar: "Elige tu avatar",
                male: "Hombre",
                female: "Mujer",
                firstName: "Nombre",
                lastName: "Apellido",
                birthDate: "Fecha de nacimiento",
                origin: "Origen",
                startGame: "Comenzar el juego",
                marriageTitle: "Matrimonio entre pa√≠ses",
                marryCountries: "Casar pa√≠ses",
                randomEvent: "Evento Aleatorio",
                declareWar: "Declarar guerra",
                makePeace: "Hacer la paz",
                war: "Guerra",
                peace: "Paz",
                select: "Seleccionar",
                selected: "Seleccionado",
                hello: "Hola",
                hi: "Hola",
                iLoveYou: "Te amo",
                iAdoreYou: "Te adoro",
                israelWarning: "¬°Cuidado! ¬°Israel en guerra con L√≠bano!",
                kiss: "Beso",
                moroccanAlgerianMarriage: "¬°Bravo! Marroqu√≠ se casa con argelino üéâ",
                marriageSuccess: "¬°Matrimonio exitoso entre {country1} y {country2}! üíë",
                needTwoCountries: "Selecciona dos pa√≠ses para casarlos",
                xpPoints: "XP: {xp} puntos",
                statsTitle: "üìä Estad√≠sticas de Guerra",
                warsLabel: "Guerras activas",
                peaceLabel: "Pa√≠ses en paz",
                marriagesLabel: "Matrimonios celebrados",
                topCountryLabel: "Pa√≠s m√°s fuerte",
                leaderboardTitle: "üèÖ Clasificaci√≥n",
                historyTitle: "üìú Historia reciente",
                warDeclared: "{country1} declara guerra a {country2} ‚öîÔ∏è",
                peaceMade: "{country1} hace la paz con {country2} üïäÔ∏è",
                marriageCelebrated: "Matrimonio celebrado: {country1} üíë {country2}"
            },
            it: {
                gameTitle: "Guerra dei Paesi",
                chooseAvatar: "Scegli il tuo avatar",
                male: "Uomo",
                female: "Donna",
                firstName: "Nome",
                lastName: "Cognome",
                birthDate: "Data di nascita",
                origin: "Origine",
                startGame: "Inizia il gioco",
                marriageTitle: "Matrimonio tra paesi",
                marryCountries: "Sposa i paesi",
                randomEvent: "Evento Casuale",
                declareWar: "Dichiarare guerra",
                makePeace: "Fare la pace",
                war: "Guerra",
                peace: "Pace",
                select: "Seleziona",
                selected: "Selezionato",
                hello: "Ciao",
                hi: "Ciao",
                iLoveYou: "Ti amo",
                iAdoreYou: "Ti adoro",
                israelWarning: "Attenzione! Israele in guerra con il Libano!",
                kiss: "Bacio",
                moroccanAlgerianMarriage: "Bravo! Marocchina si sposa con algerino üéâ",
                marriageSuccess: "Matrimonio riuscito tra {country1} e {country2}! üíë",
                needTwoCountries: "Seleziona due paesi per sposarli",
                xpPoints: "XP: {xp} punti",
                statsTitle: "üìä Statistiche di Guerra",
                warsLabel: "Guerre attive",
                peaceLabel: "Paesi in pace",
                marriagesLabel: "Matrimoni celebrati",
                topCountryLabel: "Paese pi√π forte",
                leaderboardTitle: "üèÖ Classifica",
                historyTitle: "üìú Storia recente",
                warDeclared: "{country1} dichiara guerra a {country2} ‚öîÔ∏è",
                peaceMade: "{country1} fa la pace con {country2} üïäÔ∏è",
                marriageCelebrated: "Matrimonio celebrato: {country1} üíë {country2}"
            },
            en: {
                gameTitle: "War of Countries",
                chooseAvatar: "Choose your avatar",
                male: "Male",
                female: "Female",
                firstName: "First name",
                lastName: "Last name",
                birthDate: "Date of birth",
                origin: "Origin",
                startGame: "Start game",
                marriageTitle: "Marriage between countries",
                marryCountries: "Marry countries",
                randomEvent: "Random Event",
                declareWar: "Declare war",
                makePeace: "Make peace",
                war: "War",
                peace: "Peace",
                select: "Select",
                selected: "Selected",
                hello: "Hello",
                hi: "Hi",
                iLoveYou: "I love you",
                iAdoreYou: "I adore you",
                israelWarning: "Be careful! Israel at war with Lebanon!",
                kiss: "Kiss",
                moroccanAlgerianMarriage: "Bravo! Moroccan marries Algerian üéâ",
                marriageSuccess: "Successful marriage between {country1} and {country2}! üíë",
                needTwoCountries: "Select two countries to marry them",
                xpPoints: "XP: {xp} points",
                statsTitle: "üìä War Statistics",
                warsLabel: "Active wars",
                peaceLabel: "Countries at peace",
                marriagesLabel: "Marriages celebrated",
                topCountryLabel: "Strongest country",
                leaderboardTitle: "üèÖ Leaderboard",
                historyTitle: "üìú Recent history",
                warDeclared: "{country1} declares war on {country2} ‚öîÔ∏è",
                peaceMade: "{country1} makes peace with {country2} üïäÔ∏è",
                marriageCelebrated: "Marriage celebrated: {country1} üíë {country2}"
            }
        };

        // Countries data
        const countries = [
            {name: "Afghanistan", emoji: "üá¶üá´"}, {name: "Albanie", emoji: "üá¶üá±"}, {name: "Alg√©rie", emoji: "üá©üáø"},
            {name: "Andorre", emoji: "üá¶üá©"}, {name: "Angola", emoji: "üá¶üá¥"}, {name: "Antigua-et-Barbuda", emoji: "üá¶üá¨"},
            {name: "Argentine", emoji: "üá¶üá∑"}, {name: "Arm√©nie", emoji: "üá¶üá≤"}, {name: "Australie", emoji: "üá¶üá∫"},
            {name: "Autriche", emoji: "üá¶üáπ"}, {name: "Azerba√Ødjan", emoji: "üá¶üáø"}, {name: "Bahamas", emoji: "üáßüá∏"},
            {name: "Bahre√Øn", emoji: "üáßüá≠"}, {name: "Bangladesh", emoji: "üáßüá©"}, {name: "Barbade", emoji: "üáßüáß"},
            {name: "B√©larus", emoji: "üáßüáæ"}, {name: "Belgique", emoji: "üáßüá™"}, {name: "Belize", emoji: "üáßüáø"},
            {name: "B√©nin", emoji: "üáßüáØ"}, {name: "Bhoutan", emoji: "üáßüáπ"}, {name: "Bolivie", emoji: "üáßüá¥"},
            {name: "Bosnie-Herz√©govine", emoji: "üáßüá¶"}, {name: "Botswana", emoji: "üáßüáº"}, {name: "Br√©sil", emoji: "üáßüá∑"},
            {name: "Brunei", emoji: "üáßüá≥"}, {name: "Bulgarie", emoji: "üáßüá¨"}, {name: "Burkina Faso", emoji: "üáßüá´"},
            {name: "Burundi", emoji: "üáßüáÆ"}, {name: "Cambodge", emoji: "üá∞üá≠"}, {name: "Cameroun", emoji: "üá®üá≤"},
            {name: "Canada", emoji: "üá®üá¶"}, {name: "Cap-Vert", emoji: "üá®üáª"}, {name: "Centrafrique", emoji: "üá®üá´"},
            {name: "Chili", emoji: "üá®üá±"}, {name: "Chine", emoji: "üá®üá≥"}, {name: "Chypre", emoji: "üá®üáæ"},
            {name: "Colombie", emoji: "üá®üá¥"}, {name: "Comores", emoji: "üá∞üá≤"}, {name: "Congo", emoji: "üá®üá¨"},
            {name: "Congo (RDC)", emoji: "üá®üá©"}, {name: "Cor√©e du Nord", emoji: "üá∞üáµ"}, {name: "Cor√©e du Sud", emoji: "üá∞üá∑"},
            {name: "Costa Rica", emoji: "üá®üá∑"}, {name: "C√¥te d'Ivoire", emoji: "üá®üáÆ"}, {name: "Croatie", emoji: "üá≠üá∑"},
            {name: "Cuba", emoji: "üá®üá∫"}, {name: "Danemark", emoji: "üá©üá∞"}, {name: "Djibouti", emoji: "üá©üáØ"},
            {name: "Dominique", emoji: "üá©üá≤"}, {name: "√âgypte", emoji: "üá™üá¨"}, {name: "√âmirats arabes unis", emoji: "üá¶üá™"},
            {name: "√âquateur", emoji: "üá™üá®"}, {name: "√ârythr√©e", emoji: "üá™üá∑"}, {name: "Espagne", emoji: "üá™üá∏"},
            {name: "Estonie", emoji: "üá™üá™"}, {name: "Eswatini", emoji: "üá∏üáø"}, {name: "√âtats-Unis", emoji: "üá∫üá∏"},
            {name: "√âthiopie", emoji: "üá™üáπ"}, {name: "Fidji", emoji: "üá´üáØ"}, {name: "Finlande", emoji: "üá´üáÆ"},
            {name: "France", emoji: "üá´üá∑"}, {name: "Gabon", emoji: "üá¨üá¶"}, {name: "Gambie", emoji: "üá¨üá≤"},
            {name: "G√©orgie", emoji: "üá¨üá™"}, {name: "Ghana", emoji: "üá¨üá≠"}, {name: "Gr√®ce", emoji: "üá¨üá∑"},
            {name: "Grenade", emoji: "üá¨üá©"}, {name: "Guatemala", emoji: "üá¨üáπ"}, {name: "Guin√©e", emoji: "üá¨üá≥"},
            {name: "Guin√©e-Bissau", emoji: "üá¨üáº"}, {name: "Guin√©e √©quatoriale", emoji: "üá¨üá∂"}, {name: "Guyana", emoji: "üá¨üáæ"},
            {name: "Ha√Øti", emoji: "üá≠üáπ"}, {name: "Honduras", emoji: "üá≠üá≥"}, {name: "Hongrie", emoji: "üá≠üá∫"},
            {name: "√éles Marshall", emoji: "üá≤üá≠"}, {name: "√éles Salomon", emoji: "üá∏üáß"}, {name: "Inde", emoji: "üáÆüá≥"},
            {name: "Indon√©sie", emoji: "üáÆüá©"}, {name: "Irak", emoji: "üáÆüá∂"}, {name: "Iran", emoji: "üáÆüá∑"},
            {name: "Irlande", emoji: "üáÆüá™"}, {name: "Islande", emoji: "üáÆüá∏"}, {name: "Isra√´l", emoji: "üáÆüá±"},
            {name: "Italie", emoji: "üáÆüáπ"}, {name: "Jama√Øque", emoji: "üáØüá≤"}, {name: "Japon", emoji: "üáØüáµ"},
            {name: "Jordanie", emoji: "üáØüá¥"}, {name: "Kazakhstan", emoji: "üá∞üáø"}, {name: "Kenya", emoji: "üá∞üá™"},
            {name: "Kirghizistan", emoji: "üá∞üá¨"}, {name: "Kiribati", emoji: "üá∞üáÆ"}, {name: "Kosovo", emoji: "üáΩüá∞"},
            {name: "Kowe√Øt", emoji: "üá∞üáº"}, {name: "Laos", emoji: "üá±üá¶"}, {name: "Lesotho", emoji: "üá±üá∏"},
            {name: "Lettonie", emoji: "üá±üáª"}, {name: "Liban", emoji: "üá±üáß"}, {name: "Liberia", emoji: "üá±üá∑"},
            {name: "Libye", emoji: "üá±üáæ"}, {name: "Liechtenstein", emoji: "üá±üáÆ"}, {name: "Lituanie", emoji: "üá±üáπ"},
            {name: "Luxembourg", emoji: "üá±üá∫"}, {name: "Mac√©doine du Nord", emoji: "üá≤üá∞"}, {name: "Madagascar", emoji: "üá≤üá¨"},
            {name: "Malaisie", emoji: "üá≤üáæ"}, {name: "Malawi", emoji: "üá≤üáº"}, {name: "Maldives", emoji: "üá≤üáª"},
            {name: "Mali", emoji: "üá≤üá±"}, {name: "Malte", emoji: "üá≤üáπ"}, {name: "Maroc", emoji: "üá≤üá¶"},
            {name: "Maurice", emoji: "üá≤üá∫"}, {name: "Mauritanie", emoji: "üá≤üá∑"}, {name: "Mexique", emoji: "üá≤üáΩ"},
            {name: "Micron√©sie", emoji: "üá´üá≤"}, {name: "Moldavie", emoji: "üá≤üá©"}, {name: "Monaco", emoji: "üá≤üá®"},
            {name: "Mongolie", emoji: "üá≤üá≥"}, {name: "Mont√©n√©gro", emoji: "üá≤üá™"}, {name: "Mozambique", emoji: "üá≤üáø"},
            {name: "Myanmar", emoji: "üá≤üá≤"}, {name: "Namibie", emoji: "üá≥üá¶"}, {name: "Nauru", emoji: "üá≥üá∑"},
            {name: "N√©pal", emoji: "üá≥üáµ"}, {name: "Nicaragua", emoji: "üá≥üáÆ"}, {name: "Niger", emoji: "üá≥üá™"},
            {name: "Nigeria", emoji: "üá≥üá¨"}, {name: "Norv√®ge", emoji: "üá≥üá¥"}, {name: "Nouvelle-Z√©lande", emoji: "üá≥üáø"},
            {name: "Oman", emoji: "üá¥üá≤"}, {name: "Ouganda", emoji: "üá∫üá¨"}, {name: "Ouzb√©kistan", emoji: "üá∫üáø"},
            {name: "Pakistan", emoji: "üáµüá∞"}, {name: "Palaos", emoji: "üáµüáº"}, {name: "Palestine", emoji: "üáµüá∏"},
            {name: "Panama", emoji: "üáµüá¶"}, {name: "Papouasie-Nouvelle-Guin√©e", emoji: "üáµüá¨"}, {name: "Paraguay", emoji: "üáµüáæ"},
            {name: "Pays-Bas", emoji: "üá≥üá±"}, {name: "P√©rou", emoji: "üáµüá™"}, {name: "Philippines", emoji: "üáµüá≠"},
            {name: "Pologne", emoji: "üáµüá±"}, {name: "Portugal", emoji: "üáµüáπ"}, {name: "Qatar", emoji: "üá∂üá¶"},
            {name: "R√©publique dominicaine", emoji: "üá©üá¥"}, {name: "R√©publique tch√®que", emoji: "üá®üáø"}, {name: "Roumanie", emoji: "üá∑üá¥"},
            {name: "Royaume-Uni", emoji: "üá¨üáß"}, {name: "Russie", emoji: "üá∑üá∫"}, {name: "Rwanda", emoji: "üá∑üáº"},
            {name: "Saint-Kitts-et-Nevis", emoji: "üá∞üá≥"}, {name: "Saint-Marin", emoji: "üá∏üá≤"}, {name: "Saint-Vincent", emoji: "üáªüá®"},
            {name: "Sainte-Lucie", emoji: "üá±üá®"}, {name: "Salvador", emoji: "üá∏üáª"}, {name: "Samoa", emoji: "üáºüá∏"},
            {name: "S√£o Tom√©-et-Principe", emoji: "üá∏üáπ"}, {name: "S√©n√©gal", emoji: "üá∏üá≥"}, {name: "Serbie", emoji: "üá∑üá∏"},
            {name: "Seychelles", emoji: "üá∏üá®"}, {name: "Sierra Leone", emoji: "üá∏üá±"}, {name: "Singapour", emoji: "üá∏üá¨"},
            {name: "Slovaquie", emoji: "üá∏üá∞"}, {name: "Slov√©nie", emoji: "üá∏üáÆ"}, {name: "Somalie", emoji: "üá∏üá¥"},
            {name: "Soudan", emoji: "üá∏üá©"}, {name: "Soudan du Sud", emoji: "üá∏üá∏"}, {name: "Sri Lanka", emoji: "üá±üá∞"},
            {name: "Su√®de", emoji: "üá∏üá™"}, {name: "Suisse", emoji: "üá®üá≠"}, {name: "Suriname", emoji: "üá∏üá∑"},
            {name: "Syrie", emoji: "üá∏üáæ"}, {name: "Tadjikistan", emoji: "üáπüáØ"}, {name: "Tanzanie", emoji: "üáπüáø"},
            {name: "Tchad", emoji: "üáπüá©"}, {name: "Tha√Ølande", emoji: "üáπüá≠"}, {name: "Timor oriental", emoji: "üáπüá±"},
            {name: "Togo", emoji: "üáπüá¨"}, {name: "Tonga", emoji: "üáπüá¥"}, {name: "Trinit√©-et-Tobago", emoji: "üáπüáπ"},
            {name: "Tunisie", emoji: "üáπüá≥"}, {name: "Turkm√©nistan", emoji: "üáπüá≤"}, {name: "Turquie", emoji: "üáπüá∑"},
            {name: "Tuvalu", emoji: "üáπüáª"}, {name: "Ukraine", emoji: "üá∫üá¶"}, {name: "Uruguay", emoji: "üá∫üáæ"},
            {name: "Vanuatu", emoji: "üáªüá∫"}, {name: "Vatican", emoji: "üáªüá¶"}, {name: "Venezuela", emoji: "üáªüá™"},
            {name: "Vietnam", emoji: "üáªüá≥"}, {name: "Y√©men", emoji: "üáæüá™"}, {name: "Zambie", emoji: "üáøüá≤"},
            {name: "Zimbabwe", emoji: "üáøüáº"}
        ];

        // Game state
        let currentLang = 'fr';
        let playerData = {
            gender: null,
            firstName: '',
            lastName: '',
            birthDate: '',
            origin: ''
        };
        let gameState = {
            countries: countries.map((country, index) => ({
                ...country,
                id: index,
                xp: Math.floor(Math.random() * 100),
                status: 'peace',
                selected: false
            })),
            selectedForMarriage: [],
            statistics: {
                totalWars: 0,
                totalPeace: 195,
                totalMarriages: 0,
                warHistory: [],
                marriageHistory: []
            }
        };
        
        // Count initial wars/peace (in case we change initial states later)
        gameState.statistics.totalWars = gameState.countries.filter(c => c.status === 'war').length;
        gameState.statistics.totalPeace = gameState.countries.filter(c => c.status === 'peace').length;

        // DOM Elements
        const elements = {
            languageSelect: document.getElementById('languageSelect'),
            gameTitle: document.getElementById('gameTitle'),
            chooseAvatar: document.getElementById('chooseAvatar'),
            maleLabel: document.getElementById('maleLabel'),
            femaleLabel: document.getElementById('femaleLabel'),
            firstNameLabel: document.getElementById('firstNameLabel'),
            lastNameLabel: document.getElementById('lastNameLabel'),
            birthDateLabel: document.getElementById('birthDateLabel'),
            originLabel: document.getElementById('originLabel'),
            startGameBtn: document.getElementById('startGame'),
            marriageTitle: document.getElementById('marriageTitle'),
            marryBtn: document.getElementById('marryBtn'),
            randomEventBtn: document.getElementById('randomEventBtn'),
            playerForm: document.getElementById('playerForm'),
            avatarSetup: document.getElementById('avatarSetup'),
            playerProfile: document.getElementById('playerProfile'),
            gameSection: document.getElementById('gameSection'),
            playerAvatar: document.getElementById('playerAvatar'),
            playerName: document.getElementById('playerName'),
            playerDetails: document.getElementById('playerDetails'),
            countriesList: document.getElementById('countriesList'),
            selectedCountries: document.getElementById('selectedCountries'),
            marriageMessage: document.getElementById('marriageMessage'),
            eventMessage: document.getElementById('eventMessage'),
            leaderboardList: document.getElementById('leaderboardList')
        };

        // Translation function
        function t(key, params = {}) {
            let text = translations[currentLang][key] || key;
            Object.keys(params).forEach(param => {
                text = text.replace(`{${param}}`, params[param]);
            });
            return text;
        }

        // Update UI language
        function updateLanguage() {
            elements.gameTitle.textContent = t('gameTitle');
            elements.chooseAvatar.textContent = t('chooseAvatar');
            elements.maleLabel.textContent = t('male');
            elements.femaleLabel.textContent = t('female');
            elements.firstNameLabel.textContent = t('firstName');
            elements.lastNameLabel.textContent = t('lastName');
            elements.birthDateLabel.textContent = t('birthDate');
            elements.originLabel.textContent = t('origin');
            elements.startGameBtn.textContent = t('startGame');
            elements.marriageTitle.textContent = t('marriageTitle');
            elements.marryBtn.textContent = t('marryCountries');
            elements.randomEventBtn.textContent = t('randomEvent');
            
            // Update statistics labels
            document.getElementById('statsTitle').textContent = t('statsTitle');
            document.getElementById('warsLabel').textContent = t('warsLabel');
            document.getElementById('peaceLabel').textContent = t('peaceLabel');
            document.getElementById('marriagesLabel').textContent = t('marriagesLabel');
            document.getElementById('topCountryLabel').textContent = t('topCountryLabel');
            document.getElementById('leaderboardTitle').textContent = t('leaderboardTitle');
            document.getElementById('historyTitle').textContent = t('historyTitle');
            
            // Update countries list if game is active
            if (!elements.gameSection.classList.contains('hidden')) {
                renderCountries();
            }
        }

        // Avatar selection
        document.querySelectorAll('.avatar-option').forEach(option => {
            option.addEventListener('click', function() {
                selectAvatar(this);
            });
            option.addEventListener('keypress', (e) => {
                if (e.key === 'Enter' || e.key === ' ') {
                    e.preventDefault();
                    selectAvatar(e.target);
                }
            });
        });

        function selectAvatar(element) {
            document.querySelectorAll('.avatar-option').forEach(opt => {
                opt.classList.remove('selected');
                opt.setAttribute('aria-pressed', 'false');
            });
            element.classList.add('selected');
            element.setAttribute('aria-pressed', 'true');
            playerData.gender = element.dataset.gender;
            elements.playerForm.classList.remove('hidden');
            elements.playerForm.classList.add('fade-in');
        }

        // Form submission
        elements.playerForm.addEventListener('submit', (e) => {
            e.preventDefault();
            playerData.firstName = document.getElementById('firstName').value;
            playerData.lastName = document.getElementById('lastName').value;
            playerData.birthDate = document.getElementById('birthDate').value;
            playerData.origin = document.getElementById('origin').value;
            
            console.log('Starting game with:', playerData);
            startGame();
        });

        // Start game
        function startGame() {
            elements.avatarSetup.classList.add('hidden');
            elements.playerProfile.classList.remove('hidden');
            elements.gameSection.classList.remove('hidden');
            
            // Display player info
            const avatarSvg = playerData.gender === 'male' ? 
                `<svg width="80" height="80" viewBox="0 0 100 100">
                    <circle cx="50" cy="50" r="45" fill="#4A90E2"/>
                    <circle cx="50" cy="40" r="20" fill="#FFE0BD"/>
                    <path d="M30 70 Q50 80 70 70" fill="#4A90E2"/>
                    <circle cx="40" cy="38" r="3" fill="#333"/>
                    <circle cx="60" cy="38" r="3" fill="#333"/>
                    <path d="M45 48 Q50 52 55 48" stroke="#333" stroke-width="2" fill="none"/>
                </svg>` :
                `<svg width="80" height="80" viewBox="0 0 100 100">
                    <circle cx="50" cy="50" r="45" fill="#E91E63"/>
                    <circle cx="50" cy="40" r="20" fill="#FFE0BD"/>
                    <path d="M30 70 Q50 80 70 70" fill="#E91E63"/>
                    <circle cx="40" cy="38" r="3" fill="#333"/>
                    <circle cx="60" cy="38" r="3" fill="#333"/>
                    <path d="M45 48 Q50 52 55 48" stroke="#333" stroke-width="2" fill="none"/>
                    <path d="M30 25 Q50 15 70 25" fill="#8B4513" stroke="none"/>
                </svg>`;
            
            elements.playerAvatar.innerHTML = avatarSvg;
            elements.playerName.textContent = `${playerData.firstName} ${playerData.lastName}`;
            
            // Add special badge for Yugurtha
            if (playerData.firstName === 'Yugurtha') {
                elements.playerName.innerHTML = `${playerData.firstName} ${playerData.lastName} <span style="font-size: 0.8em; color: gold;">üëë</span>`;
            }
            
            // Display birthdate nicely
            const birthDate = new Date(playerData.birthDate);
            const age = new Date().getFullYear() - birthDate.getFullYear();
            const dateStr = birthDate.toLocaleDateString(currentLang, { day: 'numeric', month: 'long', year: 'numeric' });
            
            // Special flag for Algerian players
            const flagEmoji = playerData.origin.toLowerCase().includes('alg√©r') ? ' üá©üáø' : '';
            elements.playerDetails.textContent = `${playerData.origin}${flagEmoji} ‚Ä¢ ${age} ans ‚Ä¢ ${dateStr}`;
            
            // Give Algeria extra XP if player is Algerian
            if (playerData.origin.toLowerCase().includes('alg√©r')) {
                const algeria = gameState.countries.find(c => c.name === 'Alg√©rie');
                if (algeria) {
                    algeria.xp = 100;
                }
                // Special welcome message for Algerian players
                setTimeout(() => {
                    if (playerData.firstName === 'Yugurtha') {
                        alert('Bienvenue Yugurtha ! üá©üáø One Two Three Viva l\'Alg√©rie! üí™');
                    }
                }, 500);
            }
            
            // Always give Palestine max XP
            const palestine = gameState.countries.find(c => c.name === 'Palestine');
            if (palestine) {
                palestine.xp = 100;
            }
            
            renderCountries();
            updateStatistics();
        }

        // Render countries
        function renderCountries() {
            elements.countriesList.innerHTML = '';
            
            gameState.countries.forEach(country => {
                const countryCard = document.createElement('div');
                countryCard.className = 'country-card card fade-in';
                
                // Special styling for Algeria and Palestine
                if (country.name === 'Alg√©rie' || country.name === 'Palestine') {
                    countryCard.style.background = 'linear-gradient(135deg, rgba(0, 255, 0, 0.1), rgba(255, 255, 255, 0.7))';
                    countryCard.style.border = '2px solid #34C759';
                }
                
                const statusClass = country.status === 'war' ? 'status-war' : 'status-peace';
                const statusText = country.status === 'war' ? t('war') : t('peace');
                const actionBtn = country.status === 'war' ? 
                    `<button class="btn btn-success btn-small" onclick="toggleWarPeace(${country.id})">${t('makePeace')}</button>` :
                    `<button class="btn btn-danger btn-small" onclick="toggleWarPeace(${country.id})">${t('declareWar')}</button>`;
                
                const selectBtn = country.selected ? 
                    `<button class="btn btn-primary btn-small" onclick="toggleMarriageSelection(${country.id})">${t('selected')}</button>` :
                    `<button class="btn btn-primary btn-small" onclick="toggleMarriageSelection(${country.id})">${t('select')}</button>`;
                
                countryCard.innerHTML = `
                    <div class="country-info">
                        <span class="country-flag">${country.emoji}</span>
                        <div>
                            <div class="country-name">${country.name}</div>
                            <div class="country-xp">${t('xpPoints', {xp: country.xp})}</div>
                        </div>
                    </div>
                    <div class="country-actions">
                        <span class="status ${statusClass}">${statusText}</span>
                        ${actionBtn}
                        ${selectBtn}
                    </div>
                `;
                
                elements.countriesList.appendChild(countryCard);
            });
        }

        // Update statistics display
        function updateStatistics() {
            document.getElementById('totalWars').textContent = gameState.statistics.totalWars;
            document.getElementById('totalPeace').textContent = gameState.statistics.totalPeace;
            document.getElementById('totalMarriages').textContent = gameState.statistics.totalMarriages;
            
            // Find country with highest XP
            const topCountry = gameState.countries.reduce((prev, current) => 
                (prev.xp > current.xp) ? prev : current
            );
            const topCountryElement = document.getElementById('topCountry');
            topCountryElement.textContent = `${topCountry.emoji} ${topCountry.name}`;
            
            // Special styling for Algeria
            if (topCountry.name === 'Alg√©rie') {
                topCountryElement.style.animation = 'pulse 2s infinite';
                topCountryElement.style.textShadow = '0 0 10px rgba(0,255,0,0.5)';
            }
            
            // Update history
            const historyList = document.getElementById('historyList');
            historyList.innerHTML = '';
            const recentHistory = [...gameState.statistics.warHistory, ...gameState.statistics.marriageHistory]
                .sort((a, b) => b.timestamp - a.timestamp)
                .slice(0, 10);
            
            recentHistory.forEach(event => {
                const item = document.createElement('div');
                item.className = 'history-item';
                item.textContent = event.text;
                historyList.appendChild(item);
            });

            // Update leaderboard
            elements.leaderboardList.innerHTML = '';
            [...gameState.countries]
                .sort((a, b) => b.xp - a.xp)
                .slice(0, 5)
                .forEach((country, index) => {
                    const li = document.createElement('li');
                    li.className = 'leaderboard-item';
                    li.textContent = `${index + 1}. ${country.emoji} ${country.name} - ${country.xp} XP`;
                    elements.leaderboardList.appendChild(li);
                });
        }

        // Toggle war/peace
        window.toggleWarPeace = function(countryId) {
            const country = gameState.countries.find(c => c.id === countryId);
            const wasWar = country.status === 'war';
            country.status = wasWar ? 'peace' : 'war';
            country.xp += wasWar ? 10 : -10;
            country.xp = Math.max(0, Math.min(100, country.xp));
            
            // Update statistics
            if (wasWar) {
                gameState.statistics.totalWars--;
                gameState.statistics.totalPeace++;
                gameState.statistics.warHistory.push({
                    timestamp: Date.now(),
                    text: t('peaceMade', {country1: playerData.firstName, country2: country.name})
                });
            } else {
                gameState.statistics.totalWars++;
                gameState.statistics.totalPeace--;
                gameState.statistics.warHistory.push({
                    timestamp: Date.now(),
                    text: t('warDeclared', {country1: playerData.firstName, country2: country.name})
                });
            }
            
            // Special celebration for Algeria reaching 100 XP
            if (!wasWar && country.name === 'Alg√©rie' && country.xp >= 100 && playerData.firstName === 'Yugurtha') {
                setTimeout(() => {
                    alert('üá©üáø ALG√âRIE CHAMPION ! üèÜ\nOne Two Three Viva l\'Alg√©rie!\nYugurtha le conqu√©rant! üí™');
                }, 500);
            }
            
            // Achievement for war milestones
            if (!wasWar && gameState.statistics.totalWars === 10) {
                setTimeout(() => {
                    alert('üèÜ ACHIEVEMENT D√âBLOQU√â!\n‚öîÔ∏è Seigneur de Guerre - 10 guerres d√©clar√©es!');
                }, 500);
            }
            
            updateStatistics();
            renderCountries();
        }

        // Toggle marriage selection
        window.toggleMarriageSelection = function(countryId) {
            const country = gameState.countries.find(c => c.id === countryId);
            
            if (country.selected) {
                country.selected = false;
                gameState.selectedForMarriage = gameState.selectedForMarriage.filter(id => id !== countryId);
            } else {
                if (gameState.selectedForMarriage.length < 2) {
                    country.selected = true;
                    gameState.selectedForMarriage.push(countryId);
                }
            }
            
            updateMarriageSection();
            renderCountries();
        }

        // Update marriage section
        function updateMarriageSection() {
            elements.selectedCountries.innerHTML = '';
            gameState.selectedForMarriage.forEach(id => {
                const country = gameState.countries.find(c => c.id === id);
                const div = document.createElement('div');
                div.className = 'selected-country';
                div.textContent = `${country.emoji} ${country.name}`;
                elements.selectedCountries.appendChild(div);
            });
            
            elements.marryBtn.disabled = gameState.selectedForMarriage.length !== 2;
        }

        // Marriage
        elements.marryBtn.addEventListener('click', () => {
            if (gameState.selectedForMarriage.length === 2) {
                const country1 = gameState.countries.find(c => c.id === gameState.selectedForMarriage[0]);
                const country2 = gameState.countries.find(c => c.id === gameState.selectedForMarriage[1]);
                
                // Check for special Morocco-Algeria marriage
                const isMoroccoAlgeria = 
                    (country1.name === 'Maroc' && country2.name === 'Alg√©rie') ||
                    (country1.name === 'Alg√©rie' && country2.name === 'Maroc');
                
                if (isMoroccoAlgeria) {
                    elements.marriageMessage.textContent = t('moroccanAlgerianMarriage');
                } else {
                    elements.marriageMessage.textContent = t('marriageSuccess', {
                        country1: country1.name,
                        country2: country2.name
                    });
                }
                
                // Update statistics
                gameState.statistics.totalMarriages++;
                gameState.statistics.marriageHistory.push({
                    timestamp: Date.now(),
                    text: t('marriageCelebrated', {country1: country1.name, country2: country2.name})
                });
                
                // Increase XP for married countries
                country1.xp = Math.min(100, country1.xp + 20);
                country2.xp = Math.min(100, country2.xp + 20);
                
                // Achievement for marriage milestones
                if (gameState.statistics.totalMarriages === 5) {
                    setTimeout(() => {
                        alert('üèÜ ACHIEVEMENT D√âBLOQU√â!\nüíë Cupidon International - 5 mariages c√©l√©br√©s!');
                    }, 500);
                }
                
                // Reset selection
                gameState.selectedForMarriage.forEach(id => {
                    const country = gameState.countries.find(c => c.id === id);
                    country.selected = false;
                });
                gameState.selectedForMarriage = [];
                updateMarriageSection();
                updateStatistics();
                renderCountries();
                
                setTimeout(() => {
                    elements.marriageMessage.textContent = '';
                }, 5000);
            }
        });

        // Random event
        elements.randomEventBtn.addEventListener('click', () => {
            const events = [
                t('hello'),
                t('hi'),
                t('iLoveYou'),
                t('iAdoreYou'),
                t('israelWarning'),
                t('kiss'),
                t('moroccanAlgerianMarriage')
            ];
            
            const randomEvent = events[Math.floor(Math.random() * events.length)];
            elements.eventMessage.textContent = randomEvent;
            
            setTimeout(() => {
                elements.eventMessage.textContent = '';
            }, 5000);
        });

        // Language change
        elements.languageSelect.addEventListener('change', (e) => {
            currentLang = e.target.value;
            document.documentElement.lang = currentLang;
            document.dir = currentLang === 'ar' ? 'rtl' : 'ltr';
            updateLanguage();
        });

        // Quick start for testing
        window.quickStart = function() {
            playerData.gender = 'male';
            playerData.firstName = 'Yugurtha';
            playerData.lastName = 'Adel';
            playerData.birthDate = '1998-11-20';
            playerData.origin = 'Alg√©rien';
            startGame();
        }
        
        // Reset statistics
        window.resetStats = function() {
            gameState.statistics = {
                totalWars: 0,
                totalPeace: gameState.countries.length,
                totalMarriages: 0,
                warHistory: [],
                marriageHistory: []
            };
            gameState.countries.forEach(country => {
                country.status = 'peace';
                country.xp = Math.floor(Math.random() * 100);
            });
            // Keep Algeria and Palestine at 100 XP
            const algeria = gameState.countries.find(c => c.name === 'Alg√©rie');
            const palestine = gameState.countries.find(c => c.name === 'Palestine');
            if (algeria) algeria.xp = 100;
            if (palestine) palestine.xp = 100;
            updateStatistics();
            renderCountries();
        }

        // Initialize
        updateLanguage();
    </script>
</body>
</html>
